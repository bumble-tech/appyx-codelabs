
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Navigation with Appyx</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="appyx-navigation"
                  title="Navigation with Appyx"
                  environment="web"
                  feedback-link="">
    
      <google-codelab-step label="Getting started" duration="1">
        <h2 is-upgraded>Before you begin</h2>
<p>In the previous <a href="www.previouscodelab.bumble" target="_blank">codelab</a> we&#39;ve built a simple app using Appyx. We&#39;re going to extend that and add navigation.</p>
<h2 is-upgraded>What you&#39;ll do</h2>
<ol type="1">
<li>Create a <code>ParentNode</code> that will have 2 child nodes</li>
<li>Add a <code>NavModel</code> to control navigation</li>
<li>Add transitions</li>
</ol>
<h2 is-upgraded>What you&#39;ll build</h2>
<p class="image-container"><img alt="demo" style="width: 200.00px" src="img/4f80041f1cfd2f7e.gif"></p>
<h2 is-upgraded>Access the code</h2>
<p>Clone the repo and open the <code>SimpleApp</code> project.</p>
<pre><code>git clone git@github.com:bumble-tech/appyx-codelabs.git

</code></pre>
<p>This tutorial and the <code>TODOs</code> will help you build a simple app where we&#39;ll navigate from one screen to another.</p>
<p>If at any point you&#39;re feeling stuck, you can always check out the solution inside the project.</p>
<aside class="special"><p>The <strong>appyx-codelabs</strong> repo contains starter code for all codelabs in the pathway.<br> For this codelab, use the <strong>SimpleApp</strong> project. </p>
<ul>
<li><strong>SimpleApp</strong> — Project that contains the starter and finished code for this codelab.</li>
</ul>
<p> The project contains two modules:<br></p>
<ul>
<li><strong>app</strong> – Contains the starter code for this project. Make your changes here to complete the codelab.</li>
<li><strong>solution</strong> – Contains the solution to this codelab.</li>
</ul>
</aside>
<p>You can refer to our <a href="https://bumble-tech.github.io/appyx/releases/changelog/" target="_blank">Changelog</a> for the latest release version.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Add a parent node" duration="1">
        <p>Relevant pages from the Appyx project page:</p>
<ul>
<li><a href="https://bumble-tech.github.io/appyx/apps/structure/" target="_blank">Structuring your app navigation</a></li>
<li><a href="https://bumble-tech.github.io/appyx/navigation/composable-navigation/" target="_blank">Composable navigation</a></li>
</ul>
<p>If you run the <code>app</code> now, it just shows a screen that&#39;s built with Appyx. This isn&#39;t very interesting, let&#39;s add more so we can understand how navigation works with Appyx.</p>
<h2 is-upgraded>Defining navigation targets</h2>
<p>We define the possible navigation targets using a <code>sealed class</code> inside our <code>RootNode</code>.</p>
<pre><code>sealed class NavTarget {
    object Child1 : NavTarget()
    object Child2 : NavTarget()
}

</code></pre>
<p>Next we&#39;ll change our <code>RootNode</code> to inherit from a <code>ParentNode</code> instead of a simple <code>Node</code>.</p>
<pre><code>class RootNode(
    buildContext: BuildContext
) : ParentNode&lt;RootNode.NavTarget&gt;(
    buildContext = buildContext,
    navModel = TODO(&#34;We&#39;ll add this is the following steps&#34;) 
) {
    ...
}

</code></pre>
<p>This will allow it to have a <code>navModel</code>, and actually change its own navigation destinations.</p>
<h2 is-upgraded>Resolving navigation targets</h2>
<p><code>ParentNode</code> expects us to implement the abstract method <code>resolve</code>. This is the way we associate our navigation targets to actual <code>Node</code> instances.</p>
<p>The good news is we don&#39;t even need another <code>Node</code> – we can use simple placeholders until we build one.</p>
<p>Let&#39;s use the <code>node(buildContext) { modifier -> ...}</code> method to do that as a first step – we&#39;ll soon make it more appealing!</p>
<pre><code>override fun resolve(navTarget: NavTarget, buildContext: BuildContext) =
    when (navTarget) {
        is RootNode.NavTarget.Child1 -&gt; node(buildContext) {
            Text(
                text = &#34;Placeholder for child 1&#34;,
                color = MaterialTheme.colors.onBackground
            )
        }
        is RootNode.NavTarget.Child2 -&gt; node(buildContext) {
            Text(
                text = &#34;Placeholder for child 2&#34;,
                color = MaterialTheme.colors.onBackground
            )
        }
    }

</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Add a back stack" duration="1">
        <p>Relevant pages from the Appyx project page:</p>
<ul>
<li><a href="https://bumble-tech.github.io/appyx/navmodel/" target="_blank">Navigation models</a></li>
<li><a href="https://bumble-tech.github.io/appyx/navmodel/backstack/" target="_blank">BackStack</a></li>
</ul>
<p>This project wouldn&#39;t compile just yet. <code>ParentNode</code> expects us to pass an instance of a <code>NavModel</code>. <code>NavModel</code> is the main point of control when we add children and want to switch between them.</p>
<p>We&#39;ll use a familiar <code>NavModel</code>, a <code>BackStack</code>.</p>
<p>In the previous step we added a <code>TODO()</code>, we&#39;ll address it now:</p>
<pre><code>class RootNode(
    buildContext: BuildContext,
    // Add the following block.
    // Feel free to use static imports to make it shorter!
    private val backStack: BackStack&lt;RootNode.NavTarget&gt; = BackStack(
        initialElement = RootNode.NavTarget.Child1,
        savedStateMap = buildContext.savedStateMap
    )
) : ParentNode&lt;RootNode.NavTarget&gt;(
    buildContext = buildContext,
    navModel = backStack // &lt;-- replace the TODO() with this
) {
    ...
}

</code></pre>
<p>We can now use the back stack&#39;s API to add, replace and pop children.</p>
<p>Our <code>ParentNode</code> has a back stack now but in order to make use of it, we&#39;ll need to add it to the composition. We&#39;ll modify our <code>View</code> function like so:</p>
<pre><code>@Composable
override fun View(modifier: Modifier) {
    Column(
        verticalArrangement = Arrangement.Center,
        horizontalAlignment = Alignment.CenterHorizontally,
        modifier = modifier
    ) {
        Box(
            contentAlignment = Alignment.Center,
            modifier = Modifier
                .height(200.dp)
                .fillMaxWidth()
                .background(color = if (isSystemInDarkTheme()) appyx_bright else appyx_dark)
        ) {
            Image(
                painter = painterResource(id = R.drawable.logo),
                contentDescription = &#34;Appyx Logo&#34;,
                modifier = Modifier.padding(16.dp)
            )
        }
        // This will add the child nodes to the composition
        Children(
            navModel = backStack,
            modifier = Modifier.fillMaxSize()
        )
    }
}

</code></pre>
<p>Your app will look like this:</p>
<p class="image-container"><img alt="demo" style="width: 200.00px" src="img/9156cfcc82bc66ae.png"></p>
<p>We can&#39;t navigate to the second child yet but don&#39;t worry we&#39;ll fix that in the next steps.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Improving the first child node" duration="1">
        <p>Let&#39;s update our child nodes to look nicer.</p>
<p>Open <code>Child1Node.kt</code>. We&#39;ll need to make this class inherit from <code>Node</code>.</p>
<p>Copy the following code, this will be the first screen in our app. Note that we have a button and a callback for triggering a back stack change soon.</p>
<pre><code>class Child1Node(
    buildContext: BuildContext,
    private val onButtonPressed: () -&gt; Unit // &lt;- This is how we&#39;ll trigger a change in the parent
) : Node(buildContext) {

    @Composable
    override fun View(modifier: Modifier) {
        Box(
            modifier = modifier
                .fillMaxSize()
                .background(color = MaterialTheme.colors.background)
        ) {
            Column(
                verticalArrangement = Arrangement.Center,
                horizontalAlignment = Alignment.CenterHorizontally,
                modifier = Modifier
                    .fillMaxSize()
                    .background(color = MaterialTheme.colors.background),
            ) {
                Text(
                    text = &#34;Child 1&#34;,
                    fontSize = 36.sp,
                    color = MaterialTheme.colors.onBackground,
                    modifier = Modifier.padding(bottom = 16.dp)
                )
                Button(
                    onClick = { onButtonPressed() }, // &lt;- Don&#39;t forget to use the callback
                    colors = ButtonDefaults.buttonColors(
                        backgroundColor = appyx_yellow1,
                        contentColor = appyx_dark
                    )
                ) {
                    Text(text = &#34;Press here to navigate&#34;)
                }
            }
        }
    }
}

</code></pre>
<p>The first screen will look like this:</p>
<p class="image-container"><img alt="demo" style="width: 200.00px" src="img/da789ba7005f1684.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="And the second" duration="0">
        <p>Open <code>Child2Node.kt</code>. We&#39;ll need to make this class inherit from <code>Node</code>.</p>
<p>Copy the following code, this will be the second screen in our app.</p>
<pre><code>class Child2Node(buildContext: BuildContext) : Node(buildContext) {

    @Composable
    override fun View(modifier: Modifier) {
        Column(
            verticalArrangement = Arrangement.Center,
            horizontalAlignment = Alignment.CenterHorizontally,
            modifier = Modifier
                .fillMaxSize()
                .background(color = MaterialTheme.colors.background),
        ) {
            Text(
                text = &#34;Child 2&#34;,
                fontSize = 36.sp,
                color = MaterialTheme.colors.onBackground,
                modifier = Modifier.padding(bottom = 16.dp)
            )
            Text(
                text = &#34;(now hit the back button)&#34;,
                fontSize = 12.sp,
                color = MaterialTheme.colors.onBackground
            )
        }
    }
}

</code></pre>
<p>The second screen will look like this:</p>
<p class="image-container"><img alt="demo" style="width: 200.00px" src="img/ce73de68d2c52f0c.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Connecting the dots" duration="1">
        <p>Let&#39;s now use these newly created child nodes instead of the placeholders!</p>
<p>Simply update the <code>resolve</code> function in <code>RootNode</code>:</p>
<pre><code>override fun resolve(
    navTarget: RootNode.NavTarget,
     buildContext: BuildContext
) =
    when (navTarget) {
        is Child1 -&gt; Child1Node(buildContext) { backStack.push(Child2) }
        is Child2 -&gt; Child2Node(buildContext)
    }

</code></pre>
<p>Note how we&#39;re finally passing the callback that will push the second child to the back stack when the button is pressed.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Adding transitions" duration="0">
        <p>Relevant pages from the Appyx project page:</p>
<ul>
<li><a href="https://bumble-tech.github.io/appyx/ui/transitions/" target="_blank">Transitions</a></li>
</ul>
<p>As a first step let&#39;s add fading transitions! It&#39;s a one-liner:</p>
<pre><code>Children(
    ...
    transitionHandler = rememberBackstackFader()
)

</code></pre>
<p>There are other transition handlers, such as <code>rememberBackstackSlider()</code> – you can supply a <code>transionSpec</code> in both cases:</p>
<pre><code>transitionHandler = rememberBackstackFader(transitionSpec = { spring() })

</code></pre>
<p>You can also create your own transitions easily. We&#39;ll cover this topic in another codelab.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Launch" duration="1">
        <p>Launch your app! It should look like this:</p>
<p class="image-container"><img alt="demo" style="width: 200.00px" src="img/4f80041f1cfd2f7e.gif"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Where to go from here" duration="0">
        <p>🎉 Congrats for completing this codelab! 🎉</p>
<p>Check out the other code labs to learn more about Appyx.</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
